<!-- index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Forms with Flask</title>
</head>
<body>

  <div id="formContainer">
    <!-- Dynamic forms with fieldset elements will be added here -->
  </div>

  <button onclick="addForm()">Add Form</button>
  <button onclick="gatherAndSubmitFormData()">Submit Forms</button>

  <script>
    function addForm() {
      // Create a new form
      var formContainer = document.getElementById('formContainer');
      var formNumber = formContainer.childElementCount + 1;

      var newFieldset = document.createElement('fieldset');
      var newLegend = document.createElement('legend');
      newLegend.textContent = 'Form ' + formNumber;
      newFieldset.appendChild(newLegend);

      var newForm = document.createElement('form');
      newForm.id = 'form' + formNumber;

      var newLabel = document.createElement('label');
      newLabel.textContent = 'Item ' + formNumber + ':';

      var newInput = document.createElement('input');
      newInput.type = 'text';
      newInput.name = 'item' + formNumber;

      newForm.appendChild(newLabel);
      newForm.appendChild(newInput);

      newFieldset.appendChild(newForm);
      formContainer.appendChild(newFieldset);
    }

    function gatherAndSubmitFormData() {
      var formContainer = document.getElementById('formContainer');
      var fieldsets = formContainer.querySelectorAll('fieldset');

      var formData = {};

      fieldsets.forEach((fieldset, index) => {
        var formFields = {};
        fieldset.querySelectorAll('input').forEach(input => {
          formFields[input.name] = input.value;
        });

        formData['form' + (index + 1)] = formFields;
      });

      // Send the data to the Flask backend
      fetch('/submit', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
      })
      .then(response => response.json())
      .then(data => {
        // Handle the response from the server
        console.log(data);
      })
      .catch(error => {
        console.error('Error:', error);
      });
    }
  </script>

</body>
</html>
